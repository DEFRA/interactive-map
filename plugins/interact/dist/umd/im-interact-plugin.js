"use strict";(this.webpackChunkdefra_DefraMap=this.webpackChunkdefra_DefraMap||[]).push([[936],{7:(e,t,r)=>{r.r(t),r.d(t,{manifest:()=>E});var n=r(738);function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return i(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return u=e.done,e},e:function(e){c=!0,a=e},f:function(){try{u||null==r.return||r.return()}finally{if(c)throw a}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var a={selectedFeatureStyle:{stroke:"#ff0000",fill:"rgba(255, 0, 0, 0.2)","stroke-width":2}};function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}var c=function(e,t){if(!e)return null;if("string"==typeof e)return e.trim();if("object"===u(e)){if(t&&e[t])return e[t];var r=Object.values(e)[0];return null!=r?r:null}return null};function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach(function(t){p(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function p(e,t,r){return(t=function(e){var t=function(e){if("object"!=l(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==l(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach(function(t){v(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function v(e,t,r){return(t=function(e){var t=function(e){if("object"!=y(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==y(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach(function(t){h(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function h(e,t,r){return(t=function(e){var t=function(e){if("object"!=m(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==m(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var E={InitComponent:function(e){var t=e.appState,r=e.mapState,i=e.services,u=e.buttonConfig,l=e.mapProvider,s=e.pluginConfig,p=e.pluginState,y=t.interfaceType,d=s.dataLayers,v=p.dispatch,m=p.selectedFeatures,S=p.selectionBounds,g=i.events,h=i.eventBus,O=i.closeApp,E=r.crossHair,P=r.mapStyle,w=["touch","keyboard"].includes(y),j=function(e){var t=e.mapState,r=e.pluginConfig,i=e.pluginState,a=e.services,u=e.mapProvider,c=t.markers,l=r.dataLayers,s=r.interactionMode,f=void 0===s?"marker":s,p=r.multiSelect,y=r.markerColor,d=i.dispatch,b=i.selectedFeatures,v=i.selectionBounds,m=a.eventBus,S=(0,n.useRef)(null),g=function(e){var t,r={},n=o(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;r[i.layerId]=i}}catch(e){n.e(e)}finally{n.f()}return r}(l),h=(0,n.useCallback)(function(e){var t=e.point,r=e.coords,n=function(e,t){try{return(null==e?void 0:e.getFeaturesAtPoint(t))||[]}catch(e){return console.warn("Feature query failed:",e),[]}}(u,t),i=l.length>0,a=!i||"select"!==f&&"auto"!==f?null:function(e,t){var r,n=o(e);try{for(n.s();!(r=n.n()).done;){var i,a=r.value,u=null===(i=a.layer)||void 0===i?void 0:i.id;if(t[u])return{feature:a,config:t[u]}}}catch(e){n.e(e)}finally{n.f()}return null}(n,g);if(a){var s;c.remove("location");var b=a.feature,v=a.config,S=null===(s=b.properties)||void 0===s?void 0:s[v.idProperty];S&&d({type:"TOGGLE_SELECTED_FEATURES",payload:{featureId:S,multiSelect:p,layerId:v.layerId,idProperty:v.idProperty,properties:b.properties,geometry:b.geometry}})}else("marker"===f||"auto"===f&&i)&&(d({type:"CLEAR_SELECTED_FEATURES"}),c.add("location",r,{color:y}),m.emit("interact:markerchange",{coords:r}))},[u,l,f,p,m,d,c]);return(0,n.useEffect)(function(){v&&b!==S.current&&(m.emit("interact:selectionchange",{selectedFeatures:b,selectionBounds:v}),S.current=b)},[b,v]),{handleInteraction:h}}({appState:t,mapState:r,pluginConfig:s,pluginState:p,services:i,mapProvider:l}).handleInteraction;return function(e){var t=e.mapProvider,r=e.mapStyle,o=e.dataLayers,i=e.selectedFeatures,u=e.dispatch,l=e.events,s=e.eventBus,p=(0,n.useMemo)(function(){return r?function(e,t){var r={};return t?(e.forEach(function(e){var n=e.selectedFeatureStyle||a.selectedFeatureStyle;r[e.layerId]=f(f({},n),{},{stroke:c(n.stroke,t.id),fill:c(n.fill,t.id)})}),r):r}(o,r):null},[o,r]),y=function(){var e,r=null===(e=t.updateHighlightedFeatures)||void 0===e?void 0:e.call(t,i,p);u({type:"UPDATE_SELECTED_BOUNDS",payload:r})};(0,n.useEffect)(function(){if(t&&i&&p)return y(),s.on(l.MAP_DATA_CHANGE,y),function(){s.off(l.MAP_DATA_CHANGE,y)}},[i,t,p])}({mapProvider:l,mapStyle:P,dataLayers:d,selectedFeatures:m,selectionBounds:S,dispatch:v,events:g,eventBus:h}),(0,n.useEffect)(function(){w?E.fixAtCenter():E.hide()},[y]),(0,n.useEffect)(function(){var e=function(e){var t=e.appState,r=e.mapState,n=e.pluginState,o=e.pluginConfig,i=e.buttonConfig,a=e.events,u=e.eventBus,c=e.handleInteraction,l=e.closeApp,s=i.selectDone,f=i.selectAtTarget,p=i.selectCancel,y=t.layoutRefs.viewportRef,d=!1,v=function(e){d="Enter"===e.key&&y.current===e.target};document.addEventListener("keydown",v);var m=function(e){"Enter"===e.key&&d&&(e.preventDefault(),g())};document.addEventListener("keyup",m);var S=function(e){c(e)};u.on(a.MAP_CLICK,S);var g=function(){c(r.crossHair.getDetail())};f.onClick=g,s.onClick=function(){var e,t=(r.markers.getMarker("location")||{}).coords,i=n.selectionBounds,a=n.selectedFeatures;u.emit("interact:done",b(b(b({},t&&{coords:t}),!t&&a&&{selectedFeatures:a}),!t&&i&&{selectionBounds:i})),(null===(e=o.closeOnDone)||void 0===e||e)&&l()},p.onClick=function(){var e;u.emit("interact:cancel"),(null===(e=o.closeOnCancel)||void 0===e||e)&&l()};var h=function(e,t){r.markers.remove("location"),n.dispatch({type:"TOGGLE_SELECTED_FEATURES",payload:b({multiSelect:o.multiSelect,addToExisting:t},e)})},O=function(e){return h(e,!0)},E=function(e){return h(e,!1)};return u.on("interact:selectFeature",O),u.on("interact:unselectFeature",E),function(){s.onClick=null,f.onClick=null,p.onClick=null,document.removeEventListener("keydown",v),document.removeEventListener("keyup",m),u.off(a.MAP_CLICK,S),u.off("interact:selectFeature",O),u.off("interact:unselectFeature",E)}}({appState:t,pluginState:p,pluginConfig:s,mapState:r,buttonConfig:u,events:g,eventBus:h,handleInteraction:j,closeApp:O});return e},[t,r,p,u,h,j]),null},reducer:{initialState:{selectedFeatures:[],selectionBounds:null},actions:{TOGGLE_SELECTED_FEATURES:function(e,t){var r,n=t.featureId,o=t.multiSelect,i=t.layerId,a=t.idProperty,u=t.addToExisting,c=void 0===u||u,l=t.properties,s=t.geometry,f=Array.isArray(e.selectedFeatures)?function(e){if(Array.isArray(e))return O(e)}(r=e.selectedFeatures)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||function(e,t){if(e){if("string"==typeof e)return O(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(e,t):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}():[],p=f.findIndex(function(e){return e.featureId===n&&e.layerId===i});if(!1===c)return-1!==p&&f.splice(p,1),g(g({},e),{},{selectedFeatures:f});if(o)return-1===p?f.push({featureId:n,layerId:i,idProperty:a,properties:l,geometry:s}):f.splice(p,1),g(g({},e),{},{selectedFeatures:f});var y=-1!==p&&1===f.length?[]:[{featureId:n,layerId:i,idProperty:a,properties:l,geometry:s}];return g(g({},e),{},{selectedFeatures:y})},UPDATE_SELECTED_BOUNDS:function(e,t){return JSON.stringify(t)===JSON.stringify(e.selectionBounds)?e:g(g({},e),{},{selectionBounds:t})},CLEAR_SELECTED_FEATURES:function(e){return g(g({},e),{},{selectedFeatures:[],selectionBounds:null})}}},buttons:[{id:"selectDone",label:"Done",variant:"primary",excludeWhen:function(e){var t=e.appState,r=e.pluginConfig;return!t.isFullscreen&&!r.hasSubsequentAction},enableWhen:function(e){var t=e.mapState,r=e.pluginState;return!!t.markers.items.find(function(e){return"location"===e.id})||!!r.selectionBounds},mobile:{slot:"actions",showLabel:!0},tablet:{slot:"actions",showLabel:!0},desktop:{slot:"actions",showLabel:!0}},{id:"selectAtTarget",label:"Select",variant:"primary",hiddenWhen:function(e){var t=e.appState;return!["touch","keyboard"].includes(t.interfaceType)},mobile:{slot:"actions",showLabel:!0},tablet:{slot:"actions",showLabel:!0},desktop:{slot:"actions",showLabel:!0}},{id:"selectCancel",label:"Cancel",variant:"tertiary",hiddenWhen:function(e){var t=e.appConfig,r=e.appState;return!(["hybrid","buttonFirst"].includes(t.behaviour)&&r.isFullscreen)},mobile:{slot:"actions",showLabel:!0},tablet:{slot:"actions",showLabel:!0},desktop:{slot:"actions",showLabel:!0}}],keyboardShortcuts:[{id:"selectOrMark",group:"Select",title:"Select feature",command:"<kbd>Enter</kbd></dd>"}],api:{selectFeature:function(e,t){var r=e.services,n=t.featureId,o=t.layerId,i=t.idProperty;r.eventBus.emit("interact:selectFeature",{featureId:n,layerId:o,idProperty:i})},unselectFeature:function(e,t){var r=e.services,n=t.featureId,o=t.layerId,i=t.idProperty;r.eventBus.emit("interact:unselectFeature",{featureId:n,layerId:o,idProperty:i})}}}}}]);