"use strict";(this.webpackChunkdefra_DefraMap=this.webpackChunkdefra_DefraMap||[]).push([[447],{249:(e,t,r)=>{function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){s(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function s(e,t,r){return(t=function(e){var t=function(e){if("object"!=i(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==i(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.r(t),r.d(t,{manifest:()=>k});var l={SET_DATASETS:function(e,t){var r=t.datasets,i=t.datasetDefaults;return a(a({},e),{},{datasets:r.map(function(e){return a(a({},i),e)})})},ADD_DATASET:function(e,t){var r,i=t.dataset,n=t.datasetDefaults;return a(a({},e),{},{datasets:[].concat((r=e.datasets||[],function(e){if(Array.isArray(e))return o(e)}(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[a(a({},n),i)])})},REMOVE_DATASET:function(e,t){var r,i=t.id;return a(a({},e),{},{datasets:(null===(r=e.datasets)||void 0===r?void 0:r.filter(function(e){return e.id!==i}))||[]})},SET_DATASET_VISIBILITY:function(e,t){var r,i=t.id,o=t.visibility;return a(a({},e),{},{datasets:null===(r=e.datasets)||void 0===r?void 0:r.map(function(e){return e.id===i?a(a({},e),{},{visibility:o}):e})})}},u=r(738),c={stroke:"#d4351c",strokeWidth:2,fill:"rgba(212 53 28, 0.5)",symbolDescription:"red outline",minZoom:6,maxZoom:24,showInKey:!1,showInLayers:!1,visibility:"visible"};function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}var f=function(e,t){if(!e)return null;if("string"==typeof e)return e.trim();if("object"===d(e)){if(t&&e[t])return e[t];var r=Object.values(e)[0];return null!=r?r:null}return null};function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach(function(t){v(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function v(e,t,r){return(t=function(e){var t=function(e){if("object"!=y(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==y(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var b=function(e,t,r){var i="".concat(r.id,"-source");e.getSource(i)||e.addSource(i,{type:"vector",tiles:r.tiles,minzoom:r.minZoom||0,maxzoom:r.maxZoom||22});var o=!!r.fill,n=!!r.stroke,a=o?r.id:null,s=n?o?"".concat(r.id,"-stroke"):r.id:null,l="hidden"===r.visibility?"none":"visible";if(o&&!e.getLayer(a)){var u=f(r.fill,t);e.addLayer(m({id:a,type:"fill",source:i,"source-layer":r.sourceLayer,layout:{visibility:l},paint:{"fill-color":u,"fill-opacity":r.opacity||1}},r.filter?{filter:r.filter}:{}))}if(n&&!e.getLayer(s)){var c=f(r.stroke,t);e.addLayer(m({id:s,type:"line",source:i,"source-layer":r.sourceLayer,layout:{visibility:l},paint:m({"line-color":c,"line-width":r.strokeWidth||1,"line-opacity":r.opacity||1},r.strokeDashArray?{"line-dasharray":r.strokeDashArray}:{})},r.filter?{filter:r.filter}:{}))}},h=function(e,t){var r=e.mapProvider,i=e.pluginState,o=r.map;o.getLayer(t)&&o.setLayoutProperty(t,"visibility","visible"),o.getLayer("".concat(t,"-stroke"))&&o.setLayoutProperty("".concat(t,"-stroke"),"visibility","visible"),i.dispatch({type:"SET_DATASET_VISIBILITY",payload:{id:t,visibility:"visible"}})},g=function(e,t){var r=e.mapProvider,i=e.pluginState,o=r.map;o.getLayer(t)&&o.setLayoutProperty(t,"visibility","none"),o.getLayer("".concat(t,"-stroke"))&&o.setLayoutProperty("".concat(t,"-stroke"),"visibility","none"),i.dispatch({type:"SET_DATASET_VISIBILITY",payload:{id:t,visibility:"hidden"}})},S=r(287),k={InitComponent:function(e){var t,r=e.pluginConfig,i=e.pluginState,o=e.appState,n=e.mapState,a=e.mapProvider,s=e.services,l=i.dispatch,d=s.events,f=s.eventBus,y=!(null===(t=a.map)||void 0===t||!t.getStyle()),p=(0,u.useRef)(i);p.current=i;var m=(0,u.useRef)(null);return(0,u.useEffect)(function(){var e,t,s,u,v=null===(e=null===(t=r.includeModes)||void 0===t?void 0:t.includes(o.mode))||void 0===e||e,h=null!==(s=null===(u=r.excludeModes)||void 0===u?void 0:u.includes(o.mode))&&void 0!==s&&s;y&&v&&!h&&(m.current||(i.datasets||l({type:"SET_DATASETS",payload:{datasets:r.datasets,datasetDefaults:c}}),m.current=function(e){var t=e.pluginConfig,r=e.pluginStateRef,i=e.mapStyleId,o=e.mapProvider,n=e.events,a=e.eventBus,s=o.map,l=t.datasets,u=function(){return r.current.datasets||l};l.forEach(function(e){b(s,i,e)});var c=function(e){var t=e.map,r=e.events,i=e.getDatasets,o=function(e){t.once("idle",function(){var r=e.id;i().forEach(function(e){b(t,r,e)})})};return e.eventBus.on(r.MAP_SET_STYLE,o),o}({map:s,events:n,eventBus:a,getDatasets:u});return{remove:function(){a.off(n.MAP_SET_STYLE,c),u().forEach(function(e){var t="".concat(e.id,"-source"),r=e.fill?e.id:null,i=e.stroke?e.fill?"".concat(e.id,"-stroke"):e.id:null;i&&s.getLayer(i)&&s.removeLayer(i),r&&s.getLayer(r)&&s.removeLayer(r),s.getSource(t)&&s.removeSource(t)})}}}({mapStyleId:n.mapStyle.id,pluginConfig:r,pluginStateRef:p,mapProvider:a,events:d,eventBus:f})))},[y,o.mode]),(0,u.useEffect)(function(){return function(){m.current&&(m.current.remove(),m.current=null)}},[]),null},reducer:{initialState:{datasets:null},actions:l},panels:[{id:"datasetsLayers",label:"Layers",mobile:{slot:"bottom",modal:!0,dismissable:!0},tablet:{slot:"inset",dismissable:!0,exclusive:!0,width:"300px"},desktop:{slot:"inset",modal:!1,dismissable:!0,exclusive:!0,width:"320px"},render:function(e){var t=e.pluginState,r=e.mapProvider,i=function(e){var i=e.target,o=i.value;i.checked?h({mapProvider:r,pluginState:t},o):g({mapProvider:r,pluginState:t},o)};return(0,S.jsx)("div",{className:"im-c-datasets-layers",children:(0,S.jsx)("div",{className:"govuk-form-group",children:(0,S.jsxs)("fieldset",{className:"govuk-fieldset",children:[(0,S.jsx)("legend",{className:"govuk-visually-hidden",children:"Layers"}),(0,S.jsx)("div",{className:"govuk-checkboxes govuk-checkboxes--small","data-module":"govuk-checkboxes",children:t.datasets.filter(function(e){return e.showInLayers}).map(function(e){return(0,S.jsx)("div",{className:"im-c-datasets-layers__item",children:(0,S.jsxs)("div",{className:"govuk-checkboxes__item",children:[(0,S.jsx)("input",{className:"govuk-checkboxes__input",id:e.id,name:"layers",type:"checkbox",value:e.id,checked:"hidden"!==e.visibility,onChange:i}),(0,S.jsx)("label",{className:"im-c-datasets-layers__item-label govuk-label govuk-checkboxes__label",htmlFor:e.id,children:e.label})]})},e.id)})})]})})})}},{id:"datasetsKey",label:"Key",mobile:{slot:"bottom",modal:!0},tablet:{slot:"inset",width:"300px"},desktop:{slot:"inset",width:"320px"},render:function(e){var t=e.mapState,r=e.pluginState,i=t.mapStyle,o=function(e){return(0,S.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",children:"line"===e.keySymbolShape?(0,S.jsx)("line",{x1:e.strokeWidth/2,y1:"10",x2:20-e.strokeWidth/2,y2:"10",stroke:f(e.stroke,i.id),strokeWidth:e.strokeWidth,strokeLinecap:"round"}):(0,S.jsx)("rect",{x:e.strokeWidth/2,y:e.strokeWidth/2,width:20-e.strokeWidth,height:20-e.strokeWidth,rx:e.strokeWidth,ry:e.strokeWidth,fill:f(e.fill,i.id),stroke:f(e.stroke,i.id),strokeWidth:e.strokeWidth,strokeLinejoin:"round"})})};return(0,S.jsx)("div",{className:"im-c-datasets-key",children:r.datasets.filter(function(e){return e.showInKey&&"hidden"!==e.visibility}).map(function(e){return(0,S.jsx)("div",{className:"im-c-datasets-key__item",children:(0,S.jsxs)("div",{className:"im-c-datasets-key__item-label",children:[o(e),e.label,e.symbolDescription&&(0,S.jsxs)("span",{className:"govuk-visually-hidden",children:["(",f(e.symbolDescription,i.id),")"]})]})},e.id)})})}}],buttons:[{id:"datasetsLayers",label:"Layers",panelId:"datasetsLayers",iconId:"layers",excludeWhen:function(e){return!e.pluginConfig.datasets.find(function(e){return e.showInLayers})},mobile:{slot:"top-left",showLabel:!0},tablet:{slot:"top-left",showLabel:!0},desktop:{slot:"top-left",showLabel:!0}},{id:"datasetsKey",label:"Key",panelId:"datasetsKey",iconId:"key",excludeWhen:function(e){return!e.pluginConfig.datasets.find(function(e){return e.showInKey})},mobile:{slot:"top-left",showLabel:!0},tablet:{slot:"top-left",showLabel:!0},desktop:{slot:"top-left",showLabel:!0}}],icons:[{id:"layers",svgContent:'<path d="M13 13.74a2 2 0 0 1-2 0L2.5 8.87a1 1 0 0 1 0-1.74L11 2.26a2 2 0 0 1 2 0l8.5 4.87a1 1 0 0 1 0 1.74z"></path><path d="m20 14.285 1.5.845a1 1 0 0 1 0 1.74L13 21.74a2 2 0 0 1-2 0l-8.5-4.87a1 1 0 0 1 0-1.74l1.5-.845"></path>'},{id:"key",svgContent:'<path d="M3 5h.01"/><path d="M3 12h.01"/><path d="M3 19h.01"/><path d="M8 5h13"/><path d="M8 12h13"/><path d="M8 19h13"/>'}],api:{showDataset:h,hideDataset:g}}}}]);